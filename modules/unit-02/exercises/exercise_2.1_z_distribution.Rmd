---
title: "Probabilities and distributions"
output:
  html_document:
    toc: true
    toc_float: true
    theme: flatly
    highlight: tango
    smooth: false
---



# Introduction

This week, we will work through one main exercise.
The goal is to practice the ideas introduced in
the lecture by working with real data and the
normal distribution. In particular, this exercise
is meant to help you build intuition about
probability as *area under a curve*, and how we
use the normal distribution as a model for
continuous agronomic data.

Throughout the exercise, we will use the same
functions and ideas shown in the lecture.


## Case Study: Barley Data

We were introduced to the barley dataset
previously. These data come from a uniformity
trial, where all plots received the same treatment
and yield was measured to evaluate natural
variability across the field.

```{r}
barley <- read.csv("data/barley_uniformity.csv")
```

Letâ€™s look at the first few rows of the dataset.
Plots are identified by their row and column
positions, and yields are reported per plot rather
than per acre.

```{r}
head(barley)
```

---

## Exploring the Yield Distribution

Before we calculate probabilities, we need to
understand how yield values are distributed.

Create a new object called `yield` using the yield
column from the barley data frame, and visualize
it with a histogram.

```{r}
yield <- barley$yield
hist(yield)
```

The histogram suggests that the yield values are
approximately normally distributed. As discussed
in the lecture, real data are rarely perfectly
normal. When we use the normal distribution, we
are fitting a *model distribution* to the data,
not claiming the data follow it exactly.


## Mean and Standard Deviation

To define the normal distribution for this
dataset, we need the population mean and standard
deviation.

```{r}
mean(yield)
sd(yield)
```

We will assign these values to objects so that we
can reuse them throughout the exercise. Recall
that the population mean ($\mu$), and the
population standard deviation ($\sigma$).

```{r}
mu <- mean(yield)
sigma <- sd(yield)
```


## Using the `shadeDist()` Function

To calculate probabilities, we will use the
`shadeDist()` function from the `fastGraph`
package. As discussed earlier in the course,
packages are collections of functions that extend
base R.

The package is already available for this unit. If
you ever needed to install it yourself, you would
run the following command (without the `#`).

```{r}
# install.packages("fastGraph")
```

Load the package:

```{r}
library(fastGraph)
```

Now we can visualize the normal distribution
defined by the barley data. To draw the
distribution without shading any area, we specify
`xshade = NULL`.

```{r}
shadeDist(xshade = NULL,
          ddist = "dnorm",
          parm1 = mu,
          parm2 = sigma)
```

The x-axis represents yield values, and the y-axis
represents probability density. Probabilities
correspond to areas under this curve.


## Probabilities in the Lower Tail

What proportion of the population is expected to
have a yield value less than 100?

To answer this, we shade the area to the left of
100.

```{r}
shadeDist(xshade = 100,
          ddist = "dnorm",
          parm1 = mu,
          parm2 = sigma,
          lower.tail = TRUE)
```

Now calculate the probability of observing a yield
less than 140.

```{r}
shadeDist(xshade = 140,
          ddist = "dnorm",
          parm1 = mu,
          parm2 = sigma,
          lower.tail = TRUE)
```


## Probabilities in the Upper Tail

To calculate probabilities for values greater than
a threshold, we set `lower.tail = FALSE`.

```{r}
shadeDist(xshade = 185,
          ddist = "dnorm",
          parm1 = mu,
          parm2 = sigma,
          lower.tail = FALSE)
```

Now calculate the probability of yields greater
than 170.

```{r}
shadeDist(xshade = 170,
          ddist = "dnorm",
          parm1 = mu,
          parm2 = sigma,
          lower.tail = FALSE)
```


## Probabilities Within a Range

Sometimes we want the probability that values fall
*between* two numbers. To do this, we pass a
vector of two values to `xshade`.

```{r}
shadeDist(xshade = c(120, 170),
          ddist = "dnorm",
          parm1 = mu,
          parm2 = sigma,
          lower.tail = FALSE)
```

Now calculate the probability of yields between
136 and 182.

```{r}
shadeDist(xshade = c(136, 182),
          ddist = "dnorm",
          parm1 = mu,
          parm2 = sigma,
          lower.tail = FALSE)
```


## Probabilities Outside a Range

To calculate the probability of values *outside* a
range, we again use two values for `xshade`, but
set `lower.tail = TRUE`.

```{r}
shadeDist(xshade = c(120, 170),
          ddist = "dnorm",
          parm1 = mu,
          parm2 = sigma,
          lower.tail = TRUE)
```

Now repeat this for values outside 136 and 182.

```{r}
shadeDist(xshade = c(136, 182),
          ddist = "dnorm",
          parm1 = mu,
          parm2 = sigma,
          lower.tail = TRUE)
```


## Probability and Standard Deviations

From the lecture, we learned that about 68% of
values are expected to fall within one standard
deviation of the mean.

First, calculate the bounds:

```{r}
mu_minus_sigma <- mu - sigma
mu_plus_sigma  <- mu + sigma
```

Now calculate the probability between these values.

```{r}
shadeDist(xshade = c(mu_minus_sigma, mu_plus_sigma),
          ddist = "dnorm",
          parm1 = mu,
          parm2 = sigma,
          lower.tail = FALSE)
```

We also learned that about 95% of values lie
within 1.96 standard deviations of the mean.

```{r}
mu_minus_1.96_sigma <- mu - 1.96 * sigma
mu_plus_1.96_sigma  <- mu + 1.96 * sigma

shadeDist(xshade = c(mu_minus_1.96_sigma, mu_plus_1.96_sigma),
          ddist = "dnorm",
          parm1 = mu,
          parm2 = sigma,
          lower.tail = FALSE)
```


## Practice: Cotton Dataset

```{r}
cotton <- read.csv("data/cotton_uniformity.csv")
cotton_yield <- cotton$yield

hist(cotton_yield)

cotton_mu <- mean(cotton_yield)
cotton_sigma <- sd(cotton_yield)
```

Use `shadeDist()` to answer the following:

1. Probability of a value less than 0.7
```{r}
```

2. Probability of a value greater than 1.4
```{r}
```

3. Probability of a value between 0.7 and 1.4
```{r}
```

4. Probability of a value outside this range
```{r}
```



## Practice: Tomato Dataset

Analyze the `tomato_uniformity.csv` dataset using the same steps as above.

1. Probability of a value less than 40
```{r}
```

2. Probability of a value greater than 60
```{r}
```

3. Probability of a value between 40 and 60
```{r}
```

4. Probability of a value outside this range
```{r}
```


