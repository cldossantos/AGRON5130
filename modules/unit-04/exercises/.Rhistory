ggplot(aes(x=Block, y=row, label=plot_label)) +
geom_tile(fill="grey", color="black") +
geom_text(aes(label = plot_label))
t_test = t.test(Y ~ T, data=st_data, paired=TRUE, mu=0, alternative = 'two.sided')
t_test
library(agridat)
darwin = darwin.maize
View(darwin)
t.test(height~type, data=darwin,paired=TRUE, mu=0, alternative = 'two.sided')
write.csv(darwin, "output/darwin.csv", row.names = FALSE)
apple = archbold.apple
View(apple)
t.test(yield~gen, data=apple,paired=TRUE, mu=0, alternative = 'two.sided')
apple = archbold.apple
apple_clean = apple %>%
group_by(rep, gen) %>%
mutate(yield = mean(yield, na.rm = TRUE)) %>%
ungroup()
apple_clean = apple %>%
group_by(rep, gen) %>%
summarise(yield = mean(yield, na.rm = TRUE)) %>%
ungroup()
View(apple_clean)
t.test(yield~gen, data=apple_clean,paired=TRUE, mu=0, alternative = 'two.sided')
soybean = davidian.soybean
library(agridat)
soybean = davidian.soybean
carrot = jansen.carrot
View(carrot)
library(tidyverse)
st = data.frame(obs=c(1:20))
set.seed(041283)
mu = rep(c(83),20)
Block = rep(1:10, each=2)
B = rep(c(-2.2, -0.8, 0.3, 1.2, 1.3, 1.6, 0.7, 0.4, -0.1, -0.4), each = 2)
Treatment = rep(c("A","B"), 10)
T = rep(c(-1.1, 1.1), 10)
BT = rnorm(n=20, mean = 0, sd = 1.5)
st_data = st %>%
cbind(Block, Treatment, mu, B, T, BT) %>%
mutate(BT = round(BT,1)) %>%
mutate(Y = mu+B+T+BT) %>%
group_by(Block) %>%
sample_n(2) %>%
ungroup() %>%
select(-obs) %>%
mutate(Block = as.factor(Block))
st_data$row = rep(1:2, 10)
st_data %>%
mutate(plot_label = paste0("Treatment ", Treatment, "\n", Y)) %>%
ggplot(aes(x=Block, y=row, label=plot_label)) +
geom_tile(fill="grey", color="black") +
geom_text(aes(label = plot_label))
t_test = t.test(Y ~ T, data=st_data, paired=TRUE, mu=0, alternative = 'two.sided')
t_test
write.csv(corn_starter, "output/corn_starter.csv", row.names = FALSE)
set.seed((101689))
library(tidyverse)
trial_list = list()
for(i in c(1:10)){
A = rnorm(n=1, mean=190, sd=3)
B = rnorm(n=1, mean=195, sd=3)
treatment = rbind(A, B) %>%
as.data.frame() %>%
rownames_to_column()
names(treatment) = c("treatment", "yield")
subplot = sample(x = c(1,2), size=2)
block = rep(i, 2)
out = cbind(block, subplot, treatment) %>%
as.data.frame() %>%
mutate(plot = paste0(block, subplot)) %>%
mutate(plot = as.factor(plot)) %>%
mutate(treatment = if_else(treatment=="A", "Control", "Starter")) %>%
mutate(yield = round(yield, 1)) %>%
select(block, plot, treatment, yield) %>%
arrange(plot)
trial_list[[i]] = out
}
corn_starter = do.call(rbind.data.frame, trial_list)
write.csv(corn_starter, "output/corn_starter.csv", row.names = FALSE)
write.csv(st_data, "output/soybean_fungicide.csv", row.names = FALSE)
set.seed((101689))
library(tidyverse)
trial_list = list()
for(i in c(1:10)){
A = rnorm(n=1, mean=190, sd=3)
B = rnorm(n=1, mean=195, sd=3)
treatment = rbind(A, B) %>%
as.data.frame() %>%
rownames_to_column()
names(treatment) = c("treatment", "yield")
subplot = sample(x = c(1,2), size=2)
block = rep(i, 2)
out = cbind(block, subplot, treatment) %>%
as.data.frame() %>%
mutate(plot = paste0(block, subplot)) %>%
mutate(plot = as.factor(plot)) %>%
mutate(treatment = if_else(treatment=="A", "Control", "Starter")) %>%
mutate(yield = round(yield, 1)) %>%
select(block, plot, treatment, yield) %>%
arrange(plot)
trial_list[[i]] = out
}
corn_starter = do.call(rbind.data.frame, trial_list)
set.seed((101689))
library(tidyverse)
trial_list = list()
for(i in c(1:10)){
A = rnorm(n=1, mean=190, sd=3)
B = rnorm(n=1, mean=195, sd=3)
treatment = rbind(A, B) %>%
as.data.frame() %>%
rownames_to_column()
names(treatment) = c("treatment", "yield")
subplot = sample(x = c(1,2), size=2)
block = rep(i, 2)
out = cbind(block, subplot, treatment) %>%
as.data.frame() %>%
mutate(plot = paste0(block, subplot)) %>%
mutate(plot = as.factor(plot)) %>%
mutate(treatment = if_else(treatment=="A", "Control", "Starter")) %>%
mutate(yield = round(yield, 1)) %>%
select(block, plot, treatment, yield) %>%
arrange(plot)
trial_list[[i]] = out
}
corn_starter = do.call(rbind.data.frame, trial_list)
corn_starter_2 = read.csv("data_prep/output/corn_starter.csv")
setwd("~/data_science_for_ag_professionals/two_treatment_comparisons")
corn_starter_2 = read.csv("data_prep/output/corn_starter.csv")
View(corn_starter)
View(corn_starter_2)
library(tidyverse)
st = data.frame(obs=c(1:20))
set.seed(041083)
mu = rep(c(96),20)
Block = rep(1:10, each=2)
B = rep(c(-2.2, -0.8, 0.3, 1.2, 1.3, 1.6, 0.7, 0.4, -0.1, -0.4), each = 2)
Treatment = rep(c("A","B"), 10)
T = rep(c(-1.5, 1.5), 10)
BT = rnorm(n=20, mean = 0, sd = 2)
st_data = st %>%
cbind(Block, Treatment, mu, B, T, BT) %>%
mutate(BT = round(BT,1)) %>%
mutate(Y = mu+B+T+BT) %>%
group_by(Block) %>%
sample_n(2) %>%
ungroup() %>%
select(-obs) %>%
mutate(Block = as.factor(Block))
st_data$row = rep(1:2, 10)
st_data %>%
mutate(plot_label = paste0("Treatment ", Treatment, "\n", Y)) %>%
ggplot(aes(x=Block, y=row, label=plot_label)) +
geom_tile(fill="grey", color="black") +
geom_text(aes(label = plot_label))
write.csv(st_data, "output/wheat_fungicide.csv", row.names = FALSE)
write(apple_clean, "output/apple_genotype.csv")
write.csv(apple_clean, "output/apple_genotype.csv", row.names = FALSE)
library(tidyverse)
st = data.frame(obs=c(1:20))
set.seed(041283)
mu = rep(c(83),20)
Block = rep(1:10, each=2)
B = rep(c(-2.2, -0.8, 0.3, 1.2, 1.3, 1.6, 0.7, 0.4, -0.1, -0.4), each = 2)
Treatment = rep(c("A","B"), 10)
T = rep(c(-1.1, 1.1), 10)
BT = rnorm(n=20, mean = 0, sd = 1.5)
st_data = st %>%
cbind(Block, Treatment, mu, B, T, BT) %>%
mutate(BT = round(BT,1)) %>%
mutate(Y = mu+B+T+BT) %>%
group_by(Block) %>%
sample_n(2) %>%
ungroup() %>%
select(-obs) %>%
mutate(Block = as.factor(Block))
st_data$row = rep(1:2, 10)
st_data %>%
mutate(plot_label = paste0("Treatment ", Treatment, "\n", Y)) %>%
ggplot(aes(x=Block, y=row, label=plot_label)) +
geom_tile(fill="grey", color="black") +
geom_text(aes(label = plot_label))
write.csv(st_data, "output/soybean_manganese.csv", row.names = FALSE)
A = c(1:4)
B = c(5:8)
C = c(9:12)
D = c(13:16)
A = c(1:4)
B = c(5:8)
C = c(9:12)
D = c(13:16)
trt_A = c(1:4)
trt_B = c(5:8)
trt_C = c(9:12)
trt_D = c(13:16)
rep = c(1:4)
wide = cbind(rep, trt_A, trt_B, trt_C, trt_D)
wide = cbind(rep, trt_A, trt_B, trt_C, trt_D) %>%
as.data.frame()
wide
library(tidyverse)
wide_df = cbind(rep, trt_A, trt_B, trt_C, trt_D) %>%
as.data.frame()
wide_df
long_df = wide_df %>%
gather(Treatment, Value, trt_A:trt_D)
long_df
wide_again_df = long_df %>%
spread(Treatment, Value)
wide_again_df
Trt_A = c(1:4)
Trt_B = c(5:8)
wide_df = cbind(Rep, Trt_A, Trt_B) %>%
as.data.frame()
Rep = c(1:4)
wide_df = cbind(Rep, Trt_A, Trt_B) %>%
as.data.frame()
wide_df
long_df = wide_df %>%
gather(Treatment, Value, Trt_A:Trt_B)
long_df
wide_again_df = long_df %>%
spread(Treatment, Value)
wide_again_df
trt_differences = wide_again_df %>%
mutate(Trt_Diff = Trt_A - Trt_B)
trt_differences
soybean = read.csv("data/soybean_fungicide.csv")
View(soybean)
st = data.frame(obs=c(1:20))
set.seed(041283)
mu = rep(c(76),20)
Block = rep(1:10, each=2)
B = rep(c(-2.2, -0.8, 0.3, 1.2, 1.3, 1.6, 0.7, 0.4, -0.1, -0.4), each = 2)
Treatment = rep(c("A","B"), 10)
T = rep(c(-1.5, 1.5), 10)
BT = rnorm(n=20, mean = 0, sd = 1.5)
st_data = st %>%
cbind(Block, Treatment, mu, B, T, BT) %>%
mutate(BT = round(BT,1)) %>%
mutate(Y = mu+B+T+BT) %>%
group_by(Block) %>%
sample_n(2) %>%
ungroup() %>%
select(-obs) %>%
mutate(Block = as.factor(Block))
st_data$row = rep(1:2, 10)
st_data %>%
mutate(plot_label = paste0("Treatment ", Treatment, "\n", Y)) %>%
ggplot(aes(x=Block, y=row, label=plot_label)) +
geom_tile(fill="grey", color="black") +
geom_text(aes(label = plot_label))
View(st_data)
View(st_data)
select(Block, Treatment, Y)
st_final = st_data %>%
select(Block, Treatment, Y) %>%
rename(Yield = Y)
View(st_final)
write.csv(st_final, "output/soybean_fungicide.csv", row.names = FALSE)
soybean = read.csv("data/soybean_fungicide.csv")
View(soybean)
soybean
soybean_wide = soybean %>%
spread(Treatment, Yield)
View(soybean_wide)
diffs = soybean_wide %>%
mutate(diff = A-B)
diffs = soybean_wide %>%
mutate(diff = A-B)
Trt_A = c(1:4)
Trt_B = c(5:8)
Rep = c(1:4)
wide_df = cbind(Rep, Trt_A, Trt_B) %>%
as.data.frame()
library(tidyverse)
Trt_A = c(1:4)
Trt_B = c(5:8)
Rep = c(1:4)
wide_df = cbind(Rep, Trt_A, Trt_B) %>%
as.data.frame()
wide_df
long_df = wide_df %>%
gather(Treatment, Value, Trt_A:Trt_B)
long_df
wide_again_df = long_df %>%
spread(Treatment, Value)
wide_again_df
trt_differences = wide_again_df %>%
mutate(Trt_Diff = Trt_A - Trt_B)
trt_differences
soybean = read.csv("data/soybean_fungicide.csv")
soybean
soybean_wide = soybean %>%
spread(Treatment, Yield)
soybean_wide
diffs
diffs = soybean_wide %>%
mutate(diff = A-B)
diffs
darwin = read.csv("data/darwin.csv")
View(darwin)
darwin = read.csv("data/darwin.csv")
darwin = read.csv("data/darwin.csv")
View(darwin)
names(darwin)
darwin_wide = darwin %>%
spread(type, height)
head(darwin)
darwin_wide = darwin %>%
spread(type, height)
darwin_wide
apple = read.csv("data/apple_genotype.csv")
View(apple)
names(apple)
apple_wide = apple %>%
spread(gen, yield)
apple_wide = apple %>%
spread(gen, yield)
apple_wide = apple %>%
spread(gen, yield)
apple_wide
manganese = read.csv("data/soybean_manganese.csv")
head(manganese)
library(tidyverse)
st = data.frame(obs=c(1:20))
set.seed(041283)
mu = rep(c(83),20)
Block = rep(1:10, each=2)
B = rep(c(-2.2, -0.8, 0.3, 1.2, 1.3, 1.6, 0.7, 0.4, -0.1, -0.4), each = 2)
Treatment = rep(c("A","B"), 10)
T = rep(c(-1.1, 1.1), 10)
BT = rnorm(n=20, mean = 0, sd = 1.5)
st_data = st %>%
cbind(Block, Treatment, mu, B, T, BT) %>%
mutate(BT = round(BT,1)) %>%
mutate(Y = mu+B+T+BT) %>%
group_by(Block) %>%
sample_n(2) %>%
ungroup() %>%
select(-obs) %>%
mutate(Block = as.factor(Block))
st_data$row = rep(1:2, 10)
st_data %>%
mutate(plot_label = paste0("Treatment ", Treatment, "\n", Y)) %>%
ggplot(aes(x=Block, y=row, label=plot_label)) +
geom_tile(fill="grey", color="black") +
geom_text(aes(label = plot_label))
View(st_data)
st_data_final = st_data %>%
select(Block, Treatment, Y) %>%
rename(Yield = Y)
write.csv(st_data_final, "output/soybean_manganese.csv", row.names = FALSE)
manganese = read.csv("data/soybean_manganese.csv")
head(manganese)
manganese = read.csv("data/soybean_manganese.csv")
head(manganese)
st_data_final = st_data %>%
select(Block, Treatment, Y) %>%
rename(Yield = Y)
write.csv(st_data_final, "output/soybean_manganese.csv", row.names = FALSE)
View(st_data_final)
head(manganese)
manganese %>%
spread(Treatment, Yield)
manganese_wide = manganese %>%
spread(Treatment, Yield)
manganese_wide = manganese %>%
spread(Treatment, Yield)
manganese_wide
apple_differences = apple_wide %>%
mutate(diff = Golden - Redspur)
apple_differences
mn_diffs = manganese_wide %>%
mutate(diffs = A - B)
mn_diffs
darwin_wide = darwin %>%
spread(type, height)
darwin_wide
data = read.csv("data/wheat_fungicide.csv")
wheat = read.csv("data/wheat_fungicide.csv")
head(wheat)
library(tidyverse)
st = data.frame(obs=c(1:20))
set.seed(041083)
mu = rep(c(96),20)
Block = rep(1:10, each=2)
B = rep(c(-2.2, -0.8, 0.3, 1.2, 1.3, 1.6, 0.7, 0.4, -0.1, -0.4), each = 2)
Treatment = rep(c("A","B"), 10)
T = rep(c(-1.5, 1.5), 10)
BT = rnorm(n=20, mean = 0, sd = 2)
st_data = st %>%
cbind(Block, Treatment, mu, B, T, BT) %>%
mutate(BT = round(BT,1)) %>%
mutate(Y = mu+B+T+BT) %>%
group_by(Block) %>%
sample_n(2) %>%
ungroup() %>%
select(-obs) %>%
mutate(Block = as.factor(Block))
st_data$row = rep(1:2, 10)
st_data %>%
mutate(plot_label = paste0("Treatment ", Treatment, "\n", Y)) %>%
ggplot(aes(x=Block, y=row, label=plot_label)) +
geom_tile(fill="grey", color="black") +
geom_text(aes(label = plot_label))
st_data_final = st_data %>%
select(Block, Treatment, Y) %>%
rename(Yield = Y)
write.csv(st_data_final, "output/wheat_fungicide.csv", row.names = FALSE)
wheat = read.csv("data/wheat_fungicide.csv")
head(wheat)
wheat_wide = wheat %>%
spread(Treatment, Yield)
wheat_wide
wheat_diff = wheat_wide %>%
mutate(diff=A-B)
wheat_diff
library(tidyverse)
soybean = read.csv("data/soybean_fungicide.csv")
head(soybean0
head(soybean)
soybean = read.csv("data/soybean_fungicide.csv")
head(soybean)
soybean_wide = soybean %>%
spread(Treatment, Yield)
soybean_diff = soybean_wide %>%
mutate(diff = A-B)
soybean_diff
diff_mean = mean(soybean_diff$diff)
diff_mean = mean(soybean_diff$diff)
diff_mean
diff_sd = sd(soybean_diff$diff)
diff_sd
diff_length = length(soybean_diff$diff)
n = length(soybean_diff$diff)
diff_n = length(soybean_diff$diff)
diff_se = diff_sd / sqrt(diff_n)
qt(0.975, 10)
t_value = qt(0.975, 9)
t_value
lower_limit = diff_mean - (diff_se * t_value)
upper_limit = diff_mean + (diff_se * t_value)
lower_limit
upper_limit
lower_limit = diff_mean - (diff_se * t_value)
upper_limit = diff_mean + (diff_se * t_value)
lower_limit
upper_limit
darwin = read.csv("data/darwin.csv")
head(darwin)
darwin_wide = darwin %>%
spread(type, height)
head(darwin_wide)
darwin_diff = darwin_wide %>%
mutate(diff = cross - self)
head(darwin_diff)
darwin_diff_mean = mean(darwin_diff$diff)
darwin_diff_mean = mean(darwin_diff$diff)
darwin_diff
darwin_diff_sd = sd(darwin_diff$diff)
N = length(darwin_diff$diff)
darwin_diff_se = sd / sqrt(N)
N = length(darwin_diff$diff)
darwin_diff_se = sd / sqrt(N)
darwin_diff_N = length(darwin_diff$diff)
darwin_diff_se = darwin_diff_sd / sqrt(darwin_diff_N)
darwin_diff_se = darwin_diff_sd / sqrt(darwin_diff_N)
darwin_t_value = qt(0.975, 14)
darwin_t_value = qt(0.975, 14)
darwin_t_value
lower_limit = darwin_diff - (darwin_diff_se * darwin_t_value)
upper_limit = darwin_diff + (darwin_diff_se * darwin_t_value)
darwin_lower_limit = darwin_diff - (darwin_diff_se * darwin_t_value)
darwin_upper_limit = darwin_diff + (darwin_diff_se * darwin_t_value)
darwin_lower_limit = darwin_diff - (darwin_diff_se * darwin_t_value)
darwin_upper_limit = darwin_diff + (darwin_diff_se * darwin_t_value)
darwin_lower_limit
darwin_upper_limit
darwin_diff_mean = mean(darwin_diff$diff)
darwin_diff_mean
darwin_lower_limit = darwin_diff_mean - (darwin_diff_se * darwin_t_value)
darwin_upper_limit = darwin_diff_mean + (darwin_diff_se * darwin_t_value)
darwin_lower_limit
darwin_upper_limit
library(agricolae)
treatment_names=c("A", "B")
plot_plan = design.rcbd(trt = treatment_names, r=4)
View(plot_plan)
plot_plan$book
plot_plan = design.rcbd(trt = treatment_names, r=4, serie=2)
plot_plan$book
plot_plan = design.rcbd(trt = treatment_names, r=4)
plot_plan$book
plot_plan
plot_plan
plot_plan
library(agricolae)
treatment_names=c("A", "B")
plot_plan = design.rcbd(trt = treatment_names, r=4)
plot_plan
plot_plan = design.rcbd(trt = treatment_names, r=4, serie=2)
plot_plan$sketch
plot_plan$book
setwd("~/data_science_for_ag_professionals/two_treatment_comparisons/exercises")
hemp_varieties = c("Jerry", "Bob")
hemp_plot_plan = design.rcbd(trt = hemp_variety, r=10)
hemp_variety = c("Jerry", "Bob")
hemp_plot_plan = design.rcbd(trt = hemp_variety, r=10)
hemp_plot_plan$sketch
hemp_plot_plan$book
