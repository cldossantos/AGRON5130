"0",""
"0",""
"0",""
"0","# classify centers and rejoin with original data"
"0","centers = as.data.frame(clusters$centers) %>%"
"0","  rownames_to_column(""cluster"") %>%"
"0","  gather(attribute, value, -cluster) %>%"
"0","  mutate(named_value = case_when(value < -0.45 ~ ""low"","
"0","                                 value > 0.45 ~ ""high"","
"0","                                 value >= -0.45 & value <=0.45 ~ ""ave"")) %>%"
"0","  dplyr::select(-value) %>%"
"0","  spread(attribute, named_value) %>%"
"0","  mutate(cluster = as.numeric(cluster)) %>%"
"0","  rename(om_class = om,"
"0","         ppt_class = ppt,"
"0","         clay_class = clay,"
"0","         silt_class = silt,"
"0","         sand_class = sand,"
"0","         whc_class = whc,"
"0","         gdd_class = cum_gdd)"
"0","    "
"0","cluster_df <- clusters$cluster %>%"
"0","  enframe(name=NULL, value=""cluster"")"
"0",""
"0","classified_data <-  cluster_ready_data %>%"
"0","  cbind(cluster_df) %>%"
"0","  left_join(centers, by=""cluster"") "
"0",""
"0","centers %>%"
"0","  kableExtra::kbl()"
